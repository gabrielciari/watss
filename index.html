function mostrarRacoes() {
  const racoes = carregarRacoes();
  lista.innerHTML = "";

  const hoje = new Date();

  // Pede permissão para mostrar notificação (uma vez só)
  if (Notification.permission !== "granted") {
    Notification.requestPermission();
  }

  racoes.forEach((racao, index) => {
    const div = document.createElement("div");
    div.className = "racao";
    
    const dataValidade = new Date(racao.validade);
    const diasRestantes = Math.ceil((dataValidade - hoje) / (1000 * 60 * 60 * 24));

    // Alerta e envio para WhatsApp
    if (diasRestantes <= 30 && diasRestantes >= 0) {
      const mensagem = `⚠️ Alerta: A ração "${racao.nome}" vence em ${diasRestantes} dia(s)!`;
      console.log(mensagem);

      // Notificação na tela
      if (Notification.permission === "granted") {
        new Notification("Alerta de Ração", {
          body: mensagem,
          icon: "https://cdn-icons-png.flaticon.com/512/616/616408.png"
        });
      }

      // Define o número de destino (com DDI, DDD e número, sem espaços ou traços)
      const numero = "5599999999999"; // <-- Altere aqui para seu número com DDI/DDD

      // Monta o link do WhatsApp
      const link = `https://wa.me/${numero}?text=${encodeURIComponent(mensagem)}`;

      // Abre o WhatsApp com a mensagem pronta (só uma vez por ração)
      window.open(link, "_blank");
    }

    if (diasRestantes < 0) {
      div.classList.add("vencida");
    } else if (diasRestantes <= 5) {
      div.classList.add("alerta");
    }

    div.innerHTML = `
      <strong>${racao.nome}</strong><br>
      Validade: ${racao.validade} (${diasRestantes < 0 ? 'VENCIDA' : diasRestantes + ' dia(s)'})<br>
      Quantidade: ${racao.quantidade} kg<br>
      <button onclick="removerRacao(${index})">Remover</button>
    `;
    lista.appendChild(div);
  });
}



